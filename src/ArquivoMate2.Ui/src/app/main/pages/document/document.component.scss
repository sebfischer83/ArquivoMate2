.document-layout {
  display: flex;
  align-items: stretch;
  /* Use header-aware height; fallback to full viewport if var not set */
  height: calc(100dvh - var(--app-header-height, 0px));
  max-height: calc(100dvh - var(--app-header-height, 0px));
  min-height: 0;
  overflow: hidden; /* prevent page scroll; internal panes scroll */
}

 .main-area {
  flex: 1 1 auto;
  min-width: 0;
  padding: 0;
  display: flex;
 }

 .history-wrapper {
  /* Minimal fixed width sidebar (simplified) */
  --history-panel-width: 400px;
  flex: 0 0 var(--history-panel-width);
  width: var(--history-panel-width);
  height: 100%;
  display: flex;
  box-sizing: border-box;
 }

   /* .history-wrapper.debug-width { outline: 1px solid magenta; } */

 /* Removed previous 1100px breakpoint to stop potential toggle when near boundary causing perceived width changes */

 @media (max-width: 900px) {
  /* Stack vertically on very narrow screens */
  .document-layout { flex-direction: column; }
  .history-wrapper { width: 100%; max-width: 100%; min-width: 0; flex: 0 0 auto; order: 2; }
 }

.document-detail {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  padding: 1.25rem;
  border-radius: 0.75rem;
  width: 100%;
  min-height: 0;
  overflow: hidden;
}

 .header {
  display: flex;
  align-items: center;
  gap: 1rem;
 }

 .toolbar {
  display: flex;
  justify-content: space-between;
  gap: 1rem;
  align-items: center;
  flex-wrap: wrap;
 }
 .toolbar .left { display: flex; align-items: center; gap: 0.75rem; }
 .toolbar .actions { display: flex; gap: 0.5rem; }

 .properties { margin-top: 0.25rem; }
 .prop-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
  gap: 0.5rem 1rem;
 }
 .prop { display: flex; flex-direction: column; padding: 0.4rem 0.55rem; background: var(--tui-base-02); border-radius: 0.5rem; min-height: 56px; }
 .prop .label { font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--tui-text-03); font-weight: 600; }
 .prop .value { font-size: 0.85rem; line-height: 1.2; word-break: break-word; }
 .prop .value.mono { font-family: var(--tui-font-mono); font-size: 0.75rem; }

 .content-view { display: flex; flex-direction: column; gap: 0.5rem; margin-top: 1rem; }
 .content-toolbar { display: flex; justify-content: space-between; align-items: center; gap: 0.5rem; flex-wrap: wrap; }
 .content-toolbar .right { display: flex; gap: 0.4rem; }
 .content-box { position: relative; max-height: 400px; border: 1px solid var(--tui-base-04); border-radius: 0.5rem; background: var(--tui-base-01); padding: 0.75rem; overflow: auto; }
 .doc-content { margin: 0; font-family: var(--tui-font-mono); font-size: 0.72rem; line-height: 1.2; white-space: pre-wrap; }
 .doc-content.nowrap { white-space: pre; }
.tab-pane { display: none; }
.tab-pane.active { display: block; }
 .content-box.nowrap { white-space: pre; }

/* Ensure long history/content does not push layout */
.history-view, .content-view, .properties { min-height:0; }
.history-view { overflow:auto; }
app-document-history { display:block; max-width:100%; }
app-document-history * { word-break:break-word; }

/* Split layout for PDF preview + details */
.doc-split { display: flex; gap: 1rem; align-items: stretch; flex:1 1 auto; min-height:0; overflow:hidden; }
.preview-pane { flex: 0 0 50%; max-width: 50%; display: flex; flex-direction: column; min-height:0; overflow:hidden; }
.preview-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:0.5rem; }
.preview-frame { flex:1 1 auto; min-height:0; display:flex; overflow:auto; }
.preview-frame iframe { width: 100%; height: 100%; border: 1px solid var(--tui-base-04); border-radius: 0.5rem; background: #fff; }
.no-preview { flex:1 1 auto; display:flex; align-items:center; justify-content:center; border:1px dashed var(--tui-base-04); border-radius:0.5rem; font-size:0.8rem; color:var(--tui-text-03); }
.detail-pane { flex: 0 0 50%; max-width:50%; display: flex; flex-direction: column; min-height:0; overflow:hidden; }
.detail-pane .tab-content { flex: 1 1 auto; overflow: auto; min-height:0; }

@media (max-width: 1200px) {
  .doc-split { flex-direction: column; }
  .preview-pane, .detail-pane { flex: 1 1 auto; min-height: 40vh; }
}

 @media (max-width: 900px) {
  .prop-grid { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); }
  .content-box { max-height: 300px; }
 }

 .loader-wrapper { display: flex; align-items: center; gap: 0.75rem; font-size: 0.95rem; color: var(--tui-text-02); }

 .content dt {
  font-weight: 600;
  color: var(--tui-text-02);
 }

 .content dd {
  margin: 0;
  font-family: var(--tui-font-text);
 }

 .row { display: contents; }

 .skeleton {
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
 }

 .sk-line {
  height: 14px;
  border-radius: 7px;
  background: linear-gradient(90deg, var(--tui-base-03) 0%, var(--tui-base-02) 40%, var(--tui-base-03) 80%);
  background-size: 200% 100%;
  animation: shimmer 1.2s infinite;
 }
 .sk-line.w-30 { width: 30%; }
 .sk-line.w-40 { width: 40%; }
 .sk-line.w-55 { width: 55%; }
 .sk-line.w-65 { width: 65%; }
 .sk-line.w-25 { width: 25%; }

 @keyframes shimmer {
  0% { background-position: 100% 0; }
  100% { background-position: -100% 0; }
 }

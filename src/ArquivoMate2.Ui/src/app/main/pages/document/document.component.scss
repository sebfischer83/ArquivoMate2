.document-layout {
  display: flex;
  flex-direction: column;
  flex: 1 1 auto;
  align-items: stretch;
  min-height: 0;
  width: 100%;
  /* Kein globales overflow hidden -> verhindert versteckte Restscrollbar-Bereiche */
}

 .main-area {
  flex: 1 1 auto;
  min-width: 0;
  padding: 0;
  display: flex;
 }

 .history-wrapper {
  /* Minimal fixed width sidebar (simplified) */
  --history-panel-width: 400px;
  flex: 0 0 var(--history-panel-width);
  width: var(--history-panel-width);
  height: 100%;
  display: flex;
  box-sizing: border-box;
 }

   /* .history-wrapper.debug-width { outline: 1px solid magenta; } */

 /* Removed previous 1100px breakpoint to stop potential toggle when near boundary causing perceived width changes */

 @media (max-width: 900px) {
  /* Stack vertically on very narrow screens */
  .document-layout { flex-direction: column; }
  .history-wrapper { width: 100%; max-width: 100%; min-width: 0; flex: 0 0 auto; order: 2; }
 }

.document-detail {
  --page-header-offset: 48px; /* Höhe des globalen App-Headers (ggf. anpassen) */
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  padding: 1rem 1.25rem 1.25rem;
  border-radius: 0.75rem;
  width: 100%;
  flex: 1 1 auto;
  min-height: 0;
  /* Viewport-begrenzung hier statt auf .doc-split, damit Tabs wieder scrollen können */
  height: calc(100dvh - var(--page-header-offset) - 0.5rem); /* 1rem Sicherheitsabzug gegen Doppelscroll */
  max-height: calc(100dvh - var(--page-header-offset) - 0.5rem);
  box-sizing: border-box;
  overflow: hidden; /* kapselt interne Scrollcontainer */
}

 .header {
  display: flex;
  align-items: center;
  gap: 1rem;
 }

 .toolbar {
  display: flex;
  justify-content: space-between;
  gap: 1rem;
  align-items: center;
  flex-wrap: wrap;
 }
 .toolbar .left { display: flex; align-items: center; gap: 0.75rem; }
 .toolbar .actions { display: flex; gap: 0.5rem; }

 .properties { margin-top: 0.25rem; }
 .prop-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(210px, 1fr));
  gap: 0.5rem 1rem;
 }
 .prop { display: flex; flex-direction: column; padding: 0.4rem 0.55rem; background: var(--tui-base-02); border-radius: 0.5rem; min-height: 56px; }
 .prop .label { font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--tui-text-03); font-weight: 600; }
 .prop .value { font-size: 0.85rem; line-height: 1.2; word-break: break-word; }
 .prop .value.mono { font-family: var(--tui-font-mono); font-size: 0.75rem; }

/* Keywords section */
.keywords-box { background: var(--tui-base-02); padding:0.6rem 0.75rem 0.75rem; border-radius:0.5rem; margin-bottom:0.75rem; display:flex; flex-direction:column; gap:0.55rem; }
.keywords-header { display:flex; align-items:center; justify-content:space-between; }
.keywords-label { font-size:0.65rem; text-transform:uppercase; letter-spacing:0.05em; color:var(--tui-text-03); font-weight:600; }
.keywords-chips { display:flex; flex-wrap:wrap; gap:0.4rem; min-height:1.5rem; }
.keywords-empty { font-size:0.7rem; color: var(--tui-text-03); }
.keywords-add-row { display:flex; gap:0.5rem; align-items:center; }
.keywords-add-row input[tuiTextfield] { max-width: 180px; }
.keywords-add-row .keyword-input { max-width:180px; padding:0.35rem 0.55rem; font-size:0.75rem; border:1px solid var(--tui-base-04); border-radius:0.45rem; background:var(--tui-base-01); font-family:inherit; }
.keywords-add-row .keyword-input:focus { outline:2px solid var(--tui-focus); outline-offset:1px; }
.keyword-chip { position:relative; padding-right:1.1rem; }
.keyword-chip .chip-remove { position:absolute; top:50%; transform:translateY(-50%); right:0.25rem; background:transparent; border:none; color:var(--tui-text-03); font-size:0.85rem; line-height:1; padding:0; opacity:0; cursor:pointer; transition:opacity .15s ease, color .15s ease; }
.keyword-chip:hover .chip-remove { opacity:1; }
.keyword-chip .chip-remove:hover { color: var(--tui-negative); }
.notes-view { margin-top:0.75rem; }
.notes-wrapper { display:flex; flex-direction:column; gap:0.6rem; }
.notes-loading { font-size:0.75rem; color: var(--tui-text-03); }
.notes-error { display:flex; gap:0.75rem; align-items:center; font-size:0.75rem; color: var(--tui-negative); }
.notes-empty { font-size:0.7rem; color: var(--tui-text-03); font-style:italic; }
.notes-list { list-style:none; margin:0; padding:0; display:flex; flex-direction:column; gap:0.5rem; }
.note-item { background: var(--tui-base-02); border:1px solid var(--tui-base-04); border-radius:0.5rem; padding:0.55rem 0.7rem; display:flex; flex-direction:column; gap:0.3rem; }
.note-item .note-meta { font-size:0.55rem; letter-spacing:0.05em; text-transform:uppercase; color: var(--tui-text-03); }
.note-item .note-text { font-size:0.75rem; line-height:1.25; white-space:pre-wrap; word-break:break-word; }
.keyword-chip { transition: transform .18s ease, opacity .18s ease, background-color .3s ease; }
.keyword-chip.added { animation: kwAdd .35s ease; }
.keyword-chip.removing { opacity:0; transform:scale(.7); pointer-events:none; }
@keyframes kwAdd {
  0% { transform:scale(.6); opacity:0; }
  55% { transform:scale(1.08); opacity:1; }
  100% { transform:scale(1); opacity:1; }
}

/* Summary box aligns with property label styling */
.summary-box { background: var(--tui-base-02); padding: 0.65rem 0.75rem 0.75rem; border-radius: 0.5rem; margin-bottom: 0.75rem; }
.summary-box .summary-label { font-size: 0.65rem; text-transform: uppercase; letter-spacing: 0.05em; color: var(--tui-text-03); font-weight: 600; margin-bottom: 0.35rem; }
.summary-box .summary-text { font-size: 0.8rem; line-height: 1.25; white-space: pre-wrap; word-break: break-word; }

/* content tab no longer needs extra top margin because toolbar sits above scroll container */
.content-view { display: flex; flex-direction: column; gap: 0.5rem; margin-top: 0.5rem; }
/* content toolbar extracted to standalone component */
.content-box { position: relative; border: 1px solid var(--tui-base-04); border-radius: 0.5rem; background: var(--tui-base-01); padding: 0.75rem; overflow: auto; }
 .doc-content { margin: 0; font-family: var(--tui-font-mono); font-size: 0.72rem; line-height: 1.2; white-space: pre-wrap; }
 .doc-content.nowrap { white-space: pre; }
.tab-pane { display: none; }
.tab-pane.active { display: block; }
 .content-box.nowrap { white-space: pre; }

/* Ensure long history/content does not push layout */
.history-view, .content-view, .properties { min-height:0; }
.history-view { overflow:auto; }
app-document-history { display:block; max-width:100%; }
app-document-history * { word-break:break-word; }

/* Split layout for PDF preview + details */
.doc-split { 
  display:flex; 
  gap:1rem; 
  align-items:stretch; 
  flex:1 1 auto; 
  min-height:0; 
  overflow:hidden; /* hält beide Spalten gleich hoch innerhalb der gekappten .document-detail */
}
.preview-pane { flex: 1 1 0; display: flex; flex-direction: column; min-height:0; overflow:auto; }
.preview-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:0.5rem; }
.preview-toolbar-wrapper { position:sticky; top:0; z-index:3; padding-bottom:0.4rem; background:linear-gradient(var(--tui-base-01), var(--tui-base-01)); }
.pdf-toolbar-sticky { box-shadow:0 1px 0 0 var(--tui-base-04); }
.preview-frame { flex:1 1 auto; min-height:0; display:flex; overflow:auto; }
.preview-frame iframe { width: 100%; height: 100%; border: 1px solid var(--tui-base-04); border-radius: 0.5rem; background: #fff; }
.no-preview { flex:1 1 auto; display:flex; align-items:center; justify-content:center; border:1px dashed var(--tui-base-04); border-radius:0.5rem; font-size:0.8rem; color:var(--tui-text-03); }
.detail-pane { flex: 1 1 0; display: flex; flex-direction: column; min-height:0; overflow:hidden; }
.left-scroll { flex:1 1 auto; min-height:0; overflow:auto; display:flex; flex-direction:column; }
.detail-pane .tab-content { flex: 1 1 auto; overflow: visible; min-height:0; }
.outside-content-toolbar { position: sticky; top:0; z-index:5; margin-top:0.5rem; }
.tabs-sticky { display:none; }

/* Header Tabs (aus ausgelagerter Komponente) nimmt eigene Border, daher Abstand oben minimieren */
app-document-tabs { margin-top:0.25rem; display:block; }

/* ensure preview frame uses full column height */
.preview-frame { flex:1 1 auto; min-height:0; overflow:auto; display:flex; }

@media (max-width: 1200px) {
  .doc-split { flex-direction: column; }
  .preview-pane, .detail-pane { flex: 1 1 auto; min-height: 40vh; }
}

 @media (max-width: 900px) {
  .prop-grid { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); }
  .content-box { max-height: 300px; }
 }

 .loader-wrapper { display: flex; align-items: center; gap: 0.75rem; font-size: 0.95rem; color: var(--tui-text-02); }

 .content dt {
  font-weight: 600;
  color: var(--tui-text-02);
 }

 .content dd {
  margin: 0;
  font-family: var(--tui-font-text);
 }

 .row { display: contents; }

 .skeleton {
  display: flex;
  flex-direction: column;
  gap: 0.6rem;
 }

 .sk-line {
  height: 14px;
  border-radius: 7px;
  background: linear-gradient(90deg, var(--tui-base-03) 0%, var(--tui-base-02) 40%, var(--tui-base-03) 80%);
  background-size: 200% 100%;
  animation: shimmer 1.2s infinite;
 }
 .sk-line.w-30 { width: 30%; }
 .sk-line.w-40 { width: 40%; }
 .sk-line.w-55 { width: 55%; }
 .sk-line.w-65 { width: 65%; }
 .sk-line.w-25 { width: 25%; }

 @keyframes shimmer {
  0% { background-position: 100% 0; }
  100% { background-position: -100% 0; }
 }
